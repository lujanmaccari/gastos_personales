{% extends 'base.html' %}

{% block title %}
    {% if object %}Editar Gasto{% else %}Nuevo Gasto{% endif %}
    {% endblock %}

    {% block content %}
    <div class="min-h-screen bg-gray-50 flex items-center justify-center p-6">
    
    <div class="w-full max-w-md">
        
        <!-- Título -->
        <h1 class="text-3xl font-bold text-gray-900 text-center mb-8">
        {% if object %}Editar Gasto{% else %}Agregar Nuevo Gasto{% endif %}
        </h1>

        <!-- Card del Formulario -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-8">
        
        <form method="post" class="space-y-6">
            {% csrf_token %}

            <!-- Campo: Fecha -->
            <div>
            <label for="{{ form.fecha.id_for_label }}" 
                    class="block text-sm font-medium text-gray-700 mb-2">
                Fecha
            </label>
            <input 
                type="date"
                name="{{ form.fecha.name }}"
                id="{{ form.fecha.id_for_label }}"
                value="{{ form.fecha.value|default:'' }}"
                class="w-full px-4 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                required>
            {% if form.fecha.errors %}
                <p class="mt-2 text-sm text-red-600">{{ form.fecha.errors.0 }}</p>
            {% endif %}
            </div>

            <!-- Campo: Categoría -->
            <div>
            <label for="{{ form.categoria.id_for_label }}" 
                    class="block text-sm font-medium text-gray-700 mb-2">
                Categoría
            </label>
            <select 
                name="{{ form.categoria.name }}"
                id="{{ form.categoria.id_for_label }}"
                class="w-full px-4 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition appearance-none"
                required>
                <option value="">Seleccionar categoría</option>
                {% for value, label in form.categoria.field.choices %}
                {% if value %}
                    <option value="{{ value }}" {% if form.categoria.value == value|stringformat:"s" %}selected{% endif %}>
                    {{ label }}
                    </option>
                {% endif %}
                {% endfor %}
            </select>
            {% if form.categoria.errors %}
                <p class="mt-2 text-sm text-red-600">{{ form.categoria.errors.0 }}</p>
            {% endif %}
            </div>

            <!-- Campos: Monto y Moneda (en fila) -->
            <div class="grid grid-cols-2 gap-4">
            
            <!-- Monto -->
            <div>
                <label for="{{ form.monto.id_for_label }}" 
                    class="block text-sm font-medium text-gray-700 mb-2">
                Monto
                </label>
                <div class="relative">
                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 font-medium">$</span>
                <input 
                    type="number"
                    step="0.01"
                    name="{{ form.monto.name }}"
                    id="{{ form.monto.id_for_label }}"
                    value="{{ form.monto.value|default:'' }}"
                    class="w-full pl-8 pr-4 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                    placeholder="25.00"
                    required>
                </div>
                {% if form.monto.errors %}
                <p class="mt-2 text-sm text-red-600">{{ form.monto.errors.0 }}</p>
                {% endif %}
            </div>

            <!-- Moneda (Solo lectura) -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                Moneda
                </label>
                <div class="w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl text-gray-700 font-medium">
                {{ request.user.moneda.abreviatura|default:"ARS" }}
                </div>
            </div>

            </div>

            <!-- Campo: Descripción -->
            <div>
            <label for="{{ form.descripcion.id_for_label }}" 
                    class="block text-sm font-medium text-gray-700 mb-2">
                Descripción
            </label>
            <textarea 
                name="{{ form.descripcion.name }}"
                id="{{ form.descripcion.id_for_label }}"
                rows="3"
                class="w-full px-4 py-3 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition resize-none"
                placeholder="Agregar descripción del gasto...">{{ form.descripcion.value|default:'' }}</textarea>
            {% if form.descripcion.errors %}
                <p class="mt-2 text-sm text-red-600">{{ form.descripcion.errors.0 }}</p>
            {% endif %}
            </div>

            <!-- Botones de Acción -->
            <div class="flex gap-3 pt-4">
            <button type="submit" 
                    class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3.5 rounded-xl transition shadow-lg shadow-blue-500/20">
                {% if object %}Guardar Cambios{% else %}Guardar Gasto{% endif %}
            </button>
            
            <a href="{% url 'gastos' %}" 
                class="px-8 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3.5 rounded-xl transition text-center">
                Cancelar
            </a>
            </div>

        </form>

        </div>

    </div>

</div>
{% endblock %}